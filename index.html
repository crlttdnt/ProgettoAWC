<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PGRC</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <!-- link css -->
    <link rel="stylesheet" href="css/style.css">

    <!-- font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css"
        integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
</head>

<body class="overflow-x-hidden">

    <!-- Navigation -->
    <header>
        <div class="container-xl mx-auto pt-4">
            <div class="bg-light rounded-3 position-relative">
                <nav class="navbar navbar-expand-lg bg-body-primary">
                    <button class="navbar-toggler bg-white ms-auto me-3" type="button" data-bs-toggle="collapse"
                        data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
                        aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>

                    <div class="collapse navbar-collapse px-4" id="navbarNav">
                        <div class="d-flex me-3">
                            <a href="#">
                                <img src="img/logo.png" alt="PGRC" height="50">
                            </a>
                        </div>
                        <ul class="navbar-nav d-flex justify-content-between align-items-center w-100 m-0 gap-4">
                            <li class="nav-item">
                                <a class="nav-link text-uppercase fs-6" href="">Home</a>
                            </li>
                            <li class="loggato d-none nav-item">
                                <a class="nav-link text-uppercase fs-6" href="pag/account.html">My
                                    cookbook</a>
                            </li>
                            <li class="nav-item flex-grow-1">
                                <form class="d-flex w-100" role="search" action="pag/ricerca.html">
                                    <input class="form-control me-2 focus-ring focus-ring-light w-100" type="search"
                                        name="search" id="search" placeholder="Search" aria-label="Search">
                                    <button type="submit" class="btn btn-dark me-2">
                                        <i class="fas fa-search fs-6"></i>
                                    </button>
                                    <a class="loggato d-none btn btn-outline-dark" href="pag/account.html">
                                        <i class="far fa-user fs-6"></i>
                                    </a>
                                </form>
                            </li>
                            <li class="nav-item">
                                <a class="non-loggato btn btn-dark" data-bs-toggle="modal" data-bs-target="#login">
                                    Log In
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="non-loggato btn btn-outline-dark" data-bs-toggle="modal"
                                    data-bs-target="#new-account"> Sign up
                                </a>
                            </li>
                        </ul>
                    </div>
                </nav>

                <div class="border-top d-flex justify-content-center gap-5">
                    <div class="dropdown">
                        <button class="btn dropdown-toggle my-2 text-uppercase" type="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            Categoria
                        </button>
                        <ul class="categories_container dropdown-menu">
                            <li class="categories_item d-none">
                                <a class="category_name dropdown-item" href="#">Category</a>
                            </li>
                        </ul>
                    </div>

                    <div class="dropdown">
                        <button class="btn dropdown-toggle my-2 text-uppercase" type="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            Area
                        </button>
                        <ul class="area_container dropdown-menu">
                            <li class="area_item d-none">
                                <a class="area_name dropdown-item" href="#">Area</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

        </div>
    </header>


    <!-- Carosello di ricette -->
    <section class="container-xl mx-auto my-5">

        <!-- Carousel -->
        <div class="container-xxl my-5 py-3 d-flex justify-content-center">
            <div class="bg-light px-5 py-4 rounded-5 shadow w-75">
                <div>
                    <div class="bg-light p-2 mb-3 rounded-3 fit-content d-flex justify-content-between w-100">
                        <h4 class="text-uppercase fs-3 fw-medium mb-0">Some inspiration</h4>
                        <div class="d-flex">
                            <button class="carousel-control-prev position-relative w-100" type="button"
                                data-bs-target="#carouselSuggestions" data-bs-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Previous</span>
                            </button>
                            <button class="carousel-control-next position-relative w-100" type="button"
                                data-bs-target="#carouselSuggestions" data-bs-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Next</span>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="carouselSuggestions" class="carousel slide">
                    <div class="carousel-inner">
                        <div class="carousel-item d-none">
                            <div class="d-xl-flex gap-4">
                                <div>
                                    <a class="carousel_link" href="">
                                        <img class="carousel_img" src="" width="500" class="d-block">
                                    </a>
                                </div>
                                <div>
                                    <p>
                                    <h4 class="carousel_name">Tandoori chicken</h4>
                                    </p>
                                    <p>Category: 
                                        <a class="carousel_category" href="">
                                            <span>Chicken</span>
                                        </a>
                                    </p>
                                    
                                    <p>Area: 
                                        <a class="carousel_area" href="">
                                            <span>Indian</span>
                                        </a>
                                    </p>
                                    <p class="carousel_preparation">
                                        Mix the lemon juice with the paprika and red onions in a large shallow dish.
                                        Slash each chicken thigh three times, then turn them in the juice and set
                                        aside
                                        for 10 mins.\r\nMix all of the marinade ingredients together and pour over
                                        the
                                        chicken. Give everything a good mix, then cover and chill for at least 1 hr.
                                        This can be done up to a day in advance.\r\nHeat the grill. Lift the chicken
                                        pieces onto a rack over a baking tray. Brush over a little oil and grill for
                                        8
                                        mins on each side or until lightly charred and completely cooked through.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </section>

    <!-- Card di una Categoria Random -->
    <div class="container-xl mx-auto pt-4 my-4">
        <div class="bg-light rounded-3 position-relative p-5">
            <h4 class="text-uppercase fs-3 fw-medium mb-0">Recipes from the category "<span
                    class="random_category_name"></span>":</h4>
            <div class="category_container my-4 px-3 row text-center w-100 justify-content-center gap-3">

                <div class="category_card d-none card col flex-nowrap border-dark rounded-4 flex-shrink-0 overflow-hidden px-0"
                    style="max-width: 15rem; min-width: 15rem;">
                    <a class="card-link" href="">
                        <img src="" class="card-img card-img-top w-100" alt="...">
                        <div class="card-body">
                            <h5 class="card-title text-uppercase text-center mb-3">Nome Ricetta</h5>
                            <div class="hstack gap-3 d-flex justify-content-center">
                                <button class="card-save btn btn-outline-dark p-0" data-bs-toggle="modal"
                                    data-bs-target="#recipe-note" onclick="event.preventDefault()">
                                    <div class="px-2 py-1" data-bs-toggle="tooltip" data-bs-placement="bottom"
                                        data-bs-title="Save the recipe">
                                        <i class="far fa-heart fs-4"></i>
                                    </div>
                                </button>

                                <button href="#" class="btn btn-outline-dark comment-link px-2 py-1"
                                    data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="See the reviews">
                                    <i class="far fa-comment-dots fs-4"></i>
                                </button>
                            </div>
                        </div>
                    </a>
                </div>


            </div>
        </div>
    </div>


    <!-- Modals -->

    <!-- Modal login-->
    <div class="modal fade" id="login" tabindex="-1" aria-labelledby="login" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-body-dark">
                    <h1 class="modal-title fs-2 fw-medium">It's nice to see you again!</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="container d-flex justify-content-center align-items-center">

                        <form onsubmit="return controllaELogin(this)">
                            <div class="row py-3 align-items-center">
                                <div class="col-1">
                                    <i class="fas fa-user"></i>
                                </div>
                                <div class="col">
                                    <input name="email" id="email-utente"
                                        class="form-control focus-ring focus-ring-green" type="email"
                                        placeholder="Insert your e-mail">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-1">
                                    <i class="fas fa-lock"></i>
                                </div>
                                <div class="col mb-2">
                                    <div class="row">
                                        <div class="col pe-1">
                                            <input class="form-control focus-ring focus-ring-green password"
                                                type="password" value="" name="password"
                                                placeholder="Insert your password">
                                        </div>
                                        <div class="col-2 d-flex justify-content-end align-items-center ">
                                            <button type="button" class="btn btn-light border"
                                                onclick="mostraPassword(this)">
                                                <i class="fas fa-eye"></i>
                                                <i class="fas fa-eye-slash d-none"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class=" mt-2 d-block text-danger text-center login-errato d-none">
                                        Invalid email or password
                                    </div>
                                    <!-- <div class="pass"><a href="#" class="link-dark fs-sm text-decoration-underline">Have
                                          you forgot your password?</a>
                                  </div> -->
                                </div>

                            </div>
                            <div class="row button mx-auto mt-2 fit-content">
                                <button type="submit" class="btn btn-dark">Login</button>
                            </div>
                        </form>
                    </div>

                </div>
                <div class="modal-footer">
                    <div class="">Not registered? <a href="#" class="link-success text-decoration-underline"
                            data-bs-toggle="modal" data-bs-target="#new-account">Create an account!</a></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal new account -->
    <div class="modal fade" id="new-account" tabindex="-1" aria-labelledby="new-account" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-body-dark">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form onsubmit="return controllaERegistraUtente(this);" name="registration_form">
                        <div class="mb-3">
                            <label for="email" class="form-label">E-mail address</label>
                            <input name="email" id="email" class="form-control focus-ring focus-ring-green" type="email"
                                oninput="controllaCampo(this)" required>
                            <div class="invalid-feedback">
                                Email not valid
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-6">
                                <label for="password" class="form-label">Password</label>
                                <input name="password" id="password"
                                    class="form-control focus-ring focus-ring-green password" type="password" value=""
                                    oninput="controllaCampo(this)"
                                    pattern="^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d!?&%#.,]{8,}$"
                                    aria-describedby="password-info">
                                <div class="invalid-feedback">
                                    The password does not meet the requirements
                                </div>
                            </div>
                            <div class="col-md-6 ">
                                <label for="password2" class="form-label">Confirm password</label>
                                <div class="row mb-3">
                                    <div class="col">
                                        <input id="password2" class="form-control focus-ring focus-ring-green password"
                                            oninput="controllaUguaglianzaPassword(document.querySelector('#password'), this)"
                                            type="password" value="">
                                        <div class="invalid-feedback">
                                            The passwords are different
                                        </div>
                                    </div>
                                    <div class="col-2 ms-1 d-flex justify-content-end align-items-center ">
                                        <button type="button" class="btn btn-light border"
                                            onclick="mostraPassword(this)">
                                            <i class="fas fa-eye"></i>
                                            <i class="fas fa-eye-slash d-none"></i>
                                        </button>
                                    </div>

                                </div>

                            </div>
                            <div id="password-info" class="form-text">
                                The password must be above 8 characters and it must contain a letter and a number
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 col-12 mb-3">
                                <label for="nome" class="form-label">First name</label>
                                <input name="nome" id="nome" class="form-control focus-ring focus-ring-green"
                                    type="text" value="" oninput="controllaCampo(this)" pattern="[a-zA-Z]{2,}$"
                                    required>
                            </div>
                            <div class="col-md-6 col-12 mb-3">

                                <label for="lname" class="form-label">Last name</label>
                                <input name="lname" id="lname" class="form-control focus-ring focus-ring-green"
                                    type="text" oninput="controllaCampo(this)" pattern="[a-zA-Z]{2,}$" required>
                            </div>
                        </div>
                        <div class="row justify-content-center">
                            <div class="col-md-6 col-12 mb-3">
                                <label for="date" class="form-label">Date of Birth</label>
                                <input name="date" id="birthdate" class="form-control focus-ring focus-ring-green "
                                    type="date" oninput="controllaData(this)" required>
                            </div>
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input " id="checkbox" required>
                            <label class="form-check-label" for="checkbox">I accept terms of use and privacy
                                policy</label>
                        </div>
                        <div class=" d-flex justify-content-end">
                            <button type="reset" class="btn btn-outline-dark me-2">Cancel</button>

                            <button type="submit" class="btn btn-dark">Sign in</button>
                        </div>

                    </form>


                </div>
                <div class="modal-footer">
                    <div class="">Already have an account? <a href="#" class="link-success text-decoration-underline"
                            data-bs-toggle="modal" data-bs-target="#login">Login now!</a></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal recipe note -->
    <div class="modal fade" id="recipe-note" tabindex="-1" aria-labelledby="recipe-note" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-body-dark">
                    <h3 class="modal-title fs-4 fw-medium non-loggato">Log in to save your favourite recipes!</h3>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body ">
                    <div class="form-floating ">
                        <textarea class="form-control" placeholder="Scrivi la tua nota" id="note-text"
                            style="height: 100px"></textarea>
                        <label for="note-text">Leave here a comment for this recipe...</label>
                    </div>

                    <div class=" d-flex justify-content-end mt-4">
                        <button type="submit" class="save-recipe btn btn-dark loggato d-none" onclick="saveRecipe(this)"
                            data-bs-dismiss="modal" aria-label="Close">Add to your cookbook</button>
                        <button type="submit" class="save-recipe btn btn-dark non-loggato " data-bs-dismiss="modal"
                            aria-label="Close" disabled>Add to your cookbook</button>

                    </div>
                </div>

            </div>
        </div>
    </div>



    <!-- link javascript -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
        integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
        crossorigin="anonymous"></script>
    <script src="js/storage.js"></script>
    <script src="js/form.js"></script>
    <script src="js/api.js"></script>
    <script src="js/utils.js"></script>
    <script type="module">

        // Categories Dropdown Menu
        let categories_container = document.querySelector(".categories_container");
        let categories_template = document.querySelector(".categories_item");

        let categories = await getCategories();

        for (let category of categories) {
            let categories_item = categories_template.cloneNode(true);
            categories_item.classList.remove("d-none");
            categories_item.querySelector(".category_name").textContent = category.strCategory;
            categories_item.querySelector(".category_name").href = "pag/ricerca.html?category=" + category.strCategory;
            categories_container.appendChild(categories_item);
        }

        // Areas Dropdown Menu
        let area_container = document.querySelector(".area_container");
        let area_template = document.querySelector(".area_item");

        let areas = await getAreas();

        for (let area of areas) {
            let area_item = area_template.cloneNode(true);
            area_item.classList.remove("d-none");
            area_item.querySelector(".area_name").textContent = area.strArea;
            area_item.querySelector(".area_name").href = "pag/ricerca.html?area=" + area.strArea;
            area_container.appendChild(area_item);
        }


        // Carousel
        let carousel_container = document.querySelector(".carousel-inner");
        let carousel_template = document.querySelector(".carousel-item");

        let recipes = [];

        for (let i = 0; i < 3; i++) {
            recipes.push(await getRandomRecipe());
        }

        for (let [index, recipe] of recipes.entries()) {
            let carousel_item = carousel_template.cloneNode(true);
            carousel_item.classList.remove("d-none");
            if (index == 0) {
                carousel_item.classList.add("active");
            }
            carousel_item.querySelector(".carousel_img").src = recipe.strMealThumb;
            carousel_item.querySelector(".carousel_name").textContent = recipe.strMeal;
            carousel_item.querySelector(".carousel_category").href = "pag/ricerca.html?category=" + recipe.strCategory;
            carousel_item.querySelector(".carousel_category span").textContent = recipe.strCategory;
            carousel_item.querySelector(".carousel_area").href = "pag/ricerca.html?area=" + recipe.strArea;
            carousel_item.querySelector(".carousel_area span").textContent = recipe.strArea;
            carousel_item.querySelector(".carousel_preparation").textContent = recipe.strInstructions.substr(0, 400) + "...";
            carousel_item.querySelector(".carousel_link").href = "pag/ricetta.html?id=" + recipe.idMeal;
            carousel_container.appendChild(carousel_item);
        }
        carousel_template.remove();


        // Random Category Cards

        let random_category = categories[Math.floor(Math.random() * categories.length)].strCategory;

        document.querySelector(".random_category_name").textContent = random_category;
        let category_container = document.querySelector(".category_container");
        let category_template = document.querySelector(".category_card");

        let results = await getByCategory(random_category);
        results = results.slice(0, 8);

        for (let recipe of results) {
            let card = category_template.cloneNode(true);
            card.classList.remove("d-none");
            card.querySelector(".card-link").href = "pag/ricetta.html?id=" + recipe.idMeal;
            card.querySelector(".card-img").src = recipe.strMealThumb;
            card.querySelector(".card-title").textContent = recipe.strMeal;
            card.querySelector(".card-save").setAttribute("data-recipe", recipe.idMeal)
            if (isInCookbook(recipe.idMeal)) {
                card.querySelector(".card-save i").classList.remove("far");
                card.querySelector(".card-save i").classList.add("fas");
            }
            category_container.appendChild(card);
        }


    </script>



</body>

</html>